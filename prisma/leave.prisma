// ==================== LEAVE MODULE ====================
// Contains leave-related models

// Leave Request model
model LeaveRequest {
    id              String      @id @default(cuid())
    userId          String
    studentId       String?
    teacherId       String?
    startDate       DateTime
    endDate         DateTime
    reason          String
    type            LeaveType   @default(PERSONAL)
    status          LeaveStatus @default(PENDING)
    approvedBy      String?
    approvedAt      DateTime?
    rejectionReason String?
    documents       String?
    isPaid          Boolean     @default(false)
    createdAt       DateTime    @default(now())
    updatedAt       DateTime    @updatedAt

    // Relationships
    user     User     @relation("UserLeaveRequests", fields: [userId], references: [id])
    student  Student? @relation("StudentLeaveRequests", fields: [studentId], references: [id])
    teacher  Teacher? @relation("TeacherLeaveRequests", fields: [teacherId], references: [id])
    approver User?    @relation("ApprovedLeaveRequests", fields: [approvedBy], references: [id])

    @@map("leave_requests")
}

// Leave Balance model
model LeaveBalance {
    id            String   @id @default(cuid())
    userId        String   @unique
    studentId     String?  @unique
    teacherId     String?  @unique
    academicYear  String
    sickLeave     Int      @default(0)
    personalLeave Int      @default(0)
    vacationLeave Int      @default(0)
    usedSick      Int      @default(0)
    usedPersonal  Int      @default(0)
    usedVacation  Int      @default(0)
    createdAt     DateTime @default(now())
    updatedAt     DateTime @updatedAt

    // Relationships
    user    User     @relation("UserLeaveBalance", fields: [userId], references: [id])
    student Student? @relation("StudentLeaveBalance", fields: [studentId], references: [id])
    teacher Teacher? @relation("TeacherLeaveBalance", fields: [teacherId], references: [id])

    @@unique([userId, academicYear])
    @@map("leave_balances")
}

// Leave Policy model
model LeavePolicy {
    id                 String   @id @default(cuid())
    name               String   @unique
    description        String?
    academicYear       String
    maxSickLeave       Int      @default(5)
    maxPersonalLeave   Int      @default(3)
    maxVacationLeave   Int      @default(10)
    requireDocuments   Boolean  @default(false)
    minAdvanceDays     Int      @default(1)
    maxConsecutiveDays Int      @default(7)
    isActive           Boolean  @default(true)
    createdAt          DateTime @default(now())
    updatedAt          DateTime @updatedAt

    @@map("leave_policies")
}
